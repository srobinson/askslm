---
import Layout from '../layouts/Layout.astro'

/**
 * SETUP: Create a free Formspree account at https://formspree.io
 * 1. Sign up → Create new form → Copy the form ID
 * 2. Replace the placeholder below with your form ID
 * 3. Formspree handles email delivery, spam filtering, and submissions dashboard
 * Free tier: 50 submissions/month (plenty for a demo request form)
 */
const FORMSPREE_ID = 'YOUR_FORM_ID' // ← Replace with your Formspree form ID (e.g., 'xpwzjkdl')
const FORMSPREE_URL = `https://formspree.io/f/${FORMSPREE_ID}`
---

<Layout title="Contact" description="Request a personalized demo of AskSLM. See on-premise AI tailored to your industry and compliance requirements.">

  <!-- ===== HERO ===== -->
  <section class="relative pt-32 pb-8 md:pt-44 md:pb-12 overflow-hidden">
    <div class="absolute top-0 left-0 w-[50vw] h-[50vw] bg-radial-[at_50%_50%] from-gold/[0.015] to-transparent rounded-full pointer-events-none"></div>

    <div class="relative mx-auto max-w-[90rem] px-6 md:px-10">
      <div class="max-w-2xl">
        <p class="font-mono text-[10px] text-gold/50 tracking-[0.3em] uppercase mb-6">Contact</p>
        <h1 class="font-display text-4xl sm:text-5xl md:text-6xl tracking-[-0.02em] leading-[1.05]">
          See AskSLM in<br /><span class="text-text/40">your environment<span class="text-gold">.</span></span>
        </h1>
        <p class="mt-6 text-lg text-text max-w-xl leading-relaxed">
          Request a personalized demo — a live deployment walkthrough tailored to your industry, infrastructure, and compliance requirements.
        </p>
      </div>
    </div>
  </section>

  <!-- ===== FORM + INFO ===== -->
  <section class="pb-20 md:pb-28">
    <div class="mx-auto max-w-[90rem] px-6 md:px-10">
      <div class="grid lg:grid-cols-12 gap-12 lg:gap-20">

        <!-- LEFT: Form -->
        <div class="lg:col-span-7">
          <div class="border border-border p-8 md:p-10 rounded">
            <form
              id="contact-form"
              action={FORMSPREE_URL}
              method="POST"
              class="space-y-6"
              novalidate
            >
              <div class="grid sm:grid-cols-2 gap-6">
                <!-- Full Name -->
                <div>
                  <label for="full-name" class="block text-sm font-medium text-bright mb-2">
                    Full Name <span class="text-gold">*</span>
                  </label>
                  <input
                    type="text"
                    id="full-name"
                    name="full-name"
                    required
                    autocomplete="name"
                    placeholder="Your name"
                    class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright placeholder:text-muted focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors"
                  />
                </div>

                <!-- Work Email -->
                <div>
                  <label for="work-email" class="block text-sm font-medium text-bright mb-2">
                    Work Email <span class="text-gold">*</span>
                  </label>
                  <input
                    type="email"
                    id="work-email"
                    name="email"
                    required
                    autocomplete="email"
                    placeholder="you@company.com"
                    class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright placeholder:text-muted focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors"
                  />
                </div>
              </div>

              <div class="grid sm:grid-cols-2 gap-6">
                <!-- Company -->
                <div>
                  <label for="company" class="block text-sm font-medium text-bright mb-2">
                    Company <span class="text-gold">*</span>
                  </label>
                  <input
                    type="text"
                    id="company"
                    name="company"
                    required
                    autocomplete="organization"
                    placeholder="Organization"
                    class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright placeholder:text-muted focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors"
                  />
                </div>

                <!-- Job Title -->
                <div>
                  <label for="job-title" class="block text-sm font-medium text-bright mb-2">
                    Job Title
                  </label>
                  <input
                    type="text"
                    id="job-title"
                    name="job-title"
                    autocomplete="organization-title"
                    placeholder="Your role"
                    class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright placeholder:text-muted focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors"
                  />
                </div>
              </div>

              <!-- Industry + Company Size -->
              <div class="grid sm:grid-cols-2 gap-6">
                <div>
                  <label for="industry" class="block text-sm font-medium text-bright mb-2">
                    Industry <span class="text-gold">*</span>
                  </label>
                  <select
                    id="industry"
                    name="industry"
                    required
                    class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors appearance-none"
                    style="background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 fill=%22%2352525b%22 viewBox=%220 0 16 16%22%3E%3Cpath d=%22M4.646 5.646a.5.5 0 0 1 .708 0L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z%22/%3E%3C/svg%3E'); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1rem;"
                  >
                    <option value="" disabled selected>Select your industry</option>
                    <option value="healthcare">Healthcare</option>
                    <option value="legal">Legal</option>
                    <option value="financial-services">Financial Services</option>
                    <option value="government">Government / Public Sector</option>
                    <option value="insurance">Insurance</option>
                    <option value="education">Education & Research</option>
                    <option value="architecture-engineering">Architecture / Engineering</option>
                    <option value="other">Other</option>
                  </select>
                </div>

                <div>
                  <label for="company-size" class="block text-sm font-medium text-bright mb-2">
                    Company Size
                  </label>
                  <select
                    id="company-size"
                    name="company-size"
                    class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors appearance-none"
                    style="background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 fill=%22%2352525b%22 viewBox=%220 0 16 16%22%3E%3Cpath d=%22M4.646 5.646a.5.5 0 0 1 .708 0L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z%22/%3E%3C/svg%3E'); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1rem;"
                  >
                    <option value="" disabled selected>Select size</option>
                    <option value="1-50">1–50</option>
                    <option value="51-200">51–200</option>
                    <option value="201-1000">201–1,000</option>
                    <option value="1000+">1,000+</option>
                  </select>
                </div>
              </div>

              <!-- Message -->
              <div>
                <label for="message" class="block text-sm font-medium text-bright mb-2">
                  Message
                </label>
                <textarea
                  id="message"
                  name="message"
                  rows="4"
                  placeholder="What are you trying to solve?"
                  class="w-full rounded border border-border bg-black px-4 py-3 text-sm text-bright placeholder:text-muted focus:border-gold/50 focus:ring-1 focus:ring-gold/30 focus:outline-none transition-colors resize-y"
                ></textarea>
              </div>

              <!-- Formspree honeypot -->
              <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />

              <!-- Submit -->
              <button
                type="submit"
                id="submit-btn"
                class="w-full sm:w-auto inline-flex items-center justify-center gap-2 rounded bg-gold px-8 py-3.5 text-sm font-semibold text-black transition-all duration-200 hover:bg-gold-bright hover:glow-gold-strong cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <span id="btn-text">Request Your Demo</span>
                <svg id="btn-arrow" class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                <svg id="btn-spinner" class="h-4 w-4 animate-spin hidden" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>
              </button>

              <!-- Error message -->
              <p id="form-error" class="text-sm text-danger hidden mt-2"></p>

              <p class="text-xs text-muted mt-3">
                We respond within 1 business day. Your data is never shared.
              </p>
            </form>

            <!-- Success state (hidden by default) -->
            <div id="form-success" class="hidden text-center py-16">
              <div class="w-12 h-px bg-gold/30 mx-auto mb-8"></div>
              <h2 class="font-display text-2xl text-bright mb-3">Thank you</h2>
              <p class="text-text max-w-md mx-auto leading-relaxed">
                A member of our team will reach out within one business day to schedule your private demo.
              </p>
              <div class="w-12 h-px bg-gold/30 mx-auto mt-8"></div>
            </div>
          </div>
        </div>

        <!-- RIGHT: Info -->
        <div class="lg:col-span-5">
          <div class="sticky top-32 space-y-10">

            <!-- What to expect -->
            <div>
              <h3 class="font-display text-lg text-bright mb-6">What to expect</h3>
              <div class="space-y-5">
                {[
                  { step: '01', text: '30-minute live demo of AskSLM' },
                  { step: '02', text: 'Tailored to your industry and use cases' },
                  { step: '03', text: 'Technical deep-dive available on request' },
                  { step: '04', text: 'No commitment, no pressure' },
                ].map(item => (
                  <div class="flex items-start gap-4">
                    <span class="font-mono text-[11px] text-gold/40 mt-0.5">{item.step}</span>
                    <span class="text-sm text-text leading-relaxed">{item.text}</span>
                  </div>
                ))}
              </div>
            </div>

            <div class="h-px bg-border"></div>

            <!-- Contact info -->
            <div>
              <h3 class="font-display text-lg text-bright mb-4">Prefer email?</h3>
              <a href="mailto:contact@askslm.com" class="text-sm text-gold hover:text-gold-bright transition-colors">
                contact@askslm.com
              </a>
              <div class="mt-6">
                <p class="text-xs text-muted uppercase tracking-[0.15em] mb-1">Location</p>
                <p class="text-sm text-text">Austin, TX</p>
              </div>
            </div>

            <div class="h-px bg-border"></div>

            <!-- Trust signals -->
            <div class="space-y-4">
              {[
                'No cloud. No data leaves your environment.',
                'No slides. A live product demo.',
                'No pressure. Evaluate at your own pace.',
              ].map(text => (
                <div class="flex items-start gap-3">
                  <div class="w-5 h-px bg-gold/30 mt-[11px] shrink-0"></div>
                  <span class="text-sm text-text">{text}</span>
                </div>
              ))}
            </div>

          </div>
        </div>

      </div>
    </div>
  </section>

</Layout>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement | null
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement | null
  const btnText = document.getElementById('btn-text')
  const btnArrow = document.getElementById('btn-arrow')
  const btnSpinner = document.getElementById('btn-spinner')
  const formError = document.getElementById('form-error')
  const formSuccess = document.getElementById('form-success')

  form?.addEventListener('submit', async (e) => {
    e.preventDefault()
    if (!formError || !submitBtn || !btnText || !btnArrow || !btnSpinner || !formSuccess) return

    // Hide previous errors
    formError.classList.add('hidden')

    // Validate
    if (!form.checkValidity()) {
      form.reportValidity()
      return
    }

    // Show loading state
    submitBtn.disabled = true
    btnText.textContent = 'Sending...'
    btnArrow.classList.add('hidden')
    btnSpinner.classList.remove('hidden')

    try {
      const formData = new FormData(form)
      const response = await fetch(form.action, {
        method: 'POST',
        body: formData,
        headers: { 'Accept': 'application/json' },
      })

      if (response.ok) {
        // Hide form, show success
        form.classList.add('hidden')
        formSuccess.classList.remove('hidden')
      } else {
        const data = await response.json().catch(() => ({}))
        const errors = data.errors?.map((err: { message: string }) => err.message).join(', ')
        formError.textContent = errors || 'Something went wrong. Please try again or email contact@askslm.com directly.'
        formError.classList.remove('hidden')

        // Reset button
        submitBtn.disabled = false
        btnText.textContent = 'Request Your Demo'
        btnArrow.classList.remove('hidden')
        btnSpinner.classList.add('hidden')
      }
    } catch {
      formError.textContent = 'Network error. Please try again or email contact@askslm.com directly.'
      formError.classList.remove('hidden')

      // Reset button
      submitBtn.disabled = false
      btnText.textContent = 'Request Your Demo'
      btnArrow.classList.remove('hidden')
      btnSpinner.classList.add('hidden')
    }
  })
</script>
